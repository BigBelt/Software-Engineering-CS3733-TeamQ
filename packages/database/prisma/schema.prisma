// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider   = "prisma-client-js"
  output     = "../.prisma/client"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

model Node {
  nodeId        String          @id
  xcords        Float
  ycords        Float
  building      String
  floor         String
  nodeType      String
  longName      String
  shortName     String
  outgoing      Edge[]          @relation(name: "NodeOutgoingEdge")
  incoming      Edge[]          @relation(name: "NodeIncomingEdge")
  flowerRequest FlowerRequest[] @relation(name: "FlowerRequest")
}

model Edge {
  edgeId      String @id
  startNodeId String
  endNodeId   String
  startNode   Node   @relation(name: "NodeOutgoingEdge", fields: [startNodeId], references: [nodeId], onDelete: Cascade)
  endNode     Node   @relation(name: "NodeIncomingEdge", fields: [endNodeId], references: [nodeId], onDelete: Cascade)
}

model FlowerRequest {
  id              String   @id @default(uuid())
  nodeId          String?
  node            Node?    @relation(name: "FlowerRequest", fields: [nodeId], references: [nodeId], onUpdate: Cascade, onDelete: SetNull)
  flowerName      String
  requestDate     DateTime @default(now())
  loginName       String
  commentOnFlower String
  totalPayment    Float
  delivered       Boolean
}
